<h1>Search</h1>

<!-- ユーザー検索結果 -->
<% if @model == "user" %>

	<table class="table">
		<thead>
			<tr>
				<th>image</th>
				<th>name</th>
				<th colspan="4"></th>
			</tr>
		</thead>
		<tbody>
			<% @users.each do |user| %>
			<tr>
				<td><%= attachment_image_tag(user, :profile_image, :fill, 34, 34, fallback: "no-image-mini.jpg") %></td>
				<td><%= user.name%></td>
				<td>フォロー数：<%= user.followings.count %></td>
				<td>フォロワー数：<%= user.followers.count %></td>
				<!-- 今ログインしているユーザーじゃない場合 -->
				<% if current_user != user %>
					<!-- このユーザーは自分（ログインしているユーザー)がフォローしてないユーザーか確かめる -->
					<% if user.followed_by?(current_user) %>
					<!-- ture = フォローしている なら外すボタン -->
			  		<td><%=link_to "フォロー外す", user_relationships_path(user.id), method: :delete, class: "btn btn-warning" %></td>
					<% else %>
					<!--false = フォローしていない　ならフォローするボタン-->
			  		<td><%=link_to "フォローする", user_relationships_path(user.id), method: :post, class: "btn btn-success" %></td>
					<% end %>
				<% else %>
					<td><%= link_to "あなたです！", user_path(current_user), class: "btn btn-info" %></td>
				<% end %>
				<td><%= link_to "Show", user, class: "user_#{user.id}" %></td>
			</tr>
			<% end %>
		</tbody>
	</table>

<!-- 本 検索結果 -->
<% else %>

	<table class="table table-hover table-inverse">
	<thead>
		<tr>
			<th></th>
			<th>Title</th>
			<th>Opinion</th>
			<th colspan="5"></th>
		</tr>
	</thead>

	<tbody>
		<% @books.each do |books| %>
		<tr>
			<td>
				<%= link_to(books.user) do %>
				<%= attachment_image_tag(books.user, :profile_image, :fill, 34, 34, fallback: "no-image-mini.jpg") %>
				<% end %>
			</td>
			<td><%= link_to books.title, books, class: "book_#{books.id}" %></td>
			<td><%= books.body %></td>
			<!-- いいね機能 -->
			<td><%= render 'favorites/hart', book: books %></td>
			<!--コメント件数 -->
			<td>コメント数：<%= books.book_comments.count %></td>
		</tr>
		<% end %>
	</tbody>
</table>
<!-- 本 検索結果 -->

<% end %>
